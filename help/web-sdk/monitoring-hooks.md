---
title: Monitoring hooks for Adobe Experience Platform Web SDK
description: Learn how to use the monitoring hooks provided by the Adobe Experience Platform Web SDK to debug your implementation and capture Web SDK logs.
---

# Personalization monitoring hooks for Web SDK

The Adobe Experience Platform Web SDK includes monitoring hooks which you can use to monitor various system events. These tools are useful for developing your own debugging tools and to capture Web SDK logs.

## `onInstanceCreated` {#onInstanceCreated}

This callback function is triggered when you have successfully created a new Web SDK instance. See the sample below for details about what this function returns.

```js
onInstanceCreated(data) {
    // data.instanceName
    // data.instance
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. | 
| `data.instance` | The instance function used to call Web SDK commands. |

## `onInstanceConfigured` {#onInstanceConfigured}

This callback function is triggered by the Web SDK when the [`configure`](commands/configure/overview.md) command is successfully resolved. See the sample below for details about what this function returns.

```js
 onInstanceConfigured(data) {
     // data.instanceName
     // data.config
 }
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. | 
| `data.config` | The configuration you used for your Web SDK instance. These are the options passed to the [`configure`](commands/configure/overview.md) command with all the default values added. | 

## `onBeforeCommand` {#onBeforeCommand}

This callback function is triggered by Web SDK before any other command is executed. You can use this function to retrieve the configuration options of a specific command. See the sample below for details about what this function returns.

```js
onBeforeCommand(data) {
    // data.instanceName
    // data.commandName
    // data.options
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.commandName` | The name of the Web SDK command before which this function is executed. |
| `data.options` | The options passed to the Web SDK command before this function is executed. |


## `onCommandResolved` {#onCommandResolved}

This callback function is triggered before resolving command promise. You can use this function to see the command options and result. See the sample below for details about what this function returns.

```js
onCommandResolved(data) {
    // data.instanceName
    // data.commandName
    // data.options
    // data.result
},
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.commandName` | The name of the executed Web SDK command. |
| `data.options` | The options passed to the Web SDK command. |
| `data.result` | The result of the Web SDK command. |

## `onCommandRejected` {#onCommandRejected}

This callback function is triggered before a command promise is rejected and it contains information about the cause of the error. See the sample below for details about what this function returns.

```js
onCommandRejected(data) {
    // data.instanceName
    // data.commandName
    // data.options
    // data.error
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.commandName` | The name of the executed Web SDK command. |
| `data.options` | The options passed to the Web SDK command. |
| `data.error`  | The error message returned from the browser's network call (`fetch` in most cases). |

## `onBeforeNetworkRequest` {#onBeforeNetworkRequest}

This callback function is triggered before a network request is executed. See the sample below for details about what this function returns.

```js
onBeforeNetworkRequest(data) {
    // data.instanceName
    // data.requestId
    // data.url
    // data.payload
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.requestId`  | The `requestId` generated by Web SDK to enable debugging. |
| `data.url` | The requested URL. |
| `data.payload` | The payload object that will be converted to JSON format and sent in the body of the request, through a `POST` method. |

## `onNetworkResponse` {#onNetworkResponse}

This callback function is triggered when the browser receives a response. See the sample below for details about what this function returns.

```js
onNetworkResponse(data) {
    // data.instanceName
    // data.requestId
    // data.url
    // data.payload
    // data.body
    // data.parsedBody
    // data.status
    // data.retriesAttempted
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.requestId`  | The `requestId` generated by Web SDK to enable debugging. |
| `data.url` | The requested URL. |
| `data.payload` | The payload object that will be converted to JSON format and sent in the body of the request, through a `POST` method. |
| `data.body`  | The response body in string format. |
| `data.parsedBody` | An object containing the parsed response body. If an error occurs while parsing the response body, this parameter is undefined. |
| `data.status` | The response code in integer format. |
| `data.retriesAttempted` | The number of retries attempted when sending the request. Zero means the request was successful on the first try. |

## `onNetworkError` {#onNetworkError}

This callback function is triggered when the network request failed. See the sample below for details about what this function returns.

```js
onNetworkError(data) {
    // data.instanceName
    // data.requestId
    // data.url
    // data.payload
    // data.error
},
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.requestId`  | The `requestId` generated by Web SDK to enable debugging. |
| `data.url` | The requested URL. |
| `data.payload` | The payload object that will be converted to JSON format and sent in the body of the request, through a `POST` method. |
| `data.error`  | The error message returned from the browser's network call (`fetch` in most cases). |

## `onBeforeLog` {#onBeforeLog}

This callback function is triggered before the Web SDK logs anything to the console. See the sample below for details about what this function returns.

```js
onBeforeLog(data) {
    // data.instanceName
    // data.componentName
    // data.level
    // data.arguments
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. |
| `data.componentName` | The name of the component that generated the log message. |
| `data.level` | The logging level. Supported levels: `log`, `info`, `warn`, `error`. |
| `data.arguments` | The arguments of the log message. |


## `onContentRendering` {#onContentRendering}

This callback function is triggered by the `personalization` component, depending on the `status` parameter.

```js
 onContentRendering(data) {
     // data.instanceName
     // data.componentName
     // data.payload
     // data.status
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. | 
| `data.componentName` | The name of the component that generated the log message. |
| `data.payload` | The payload object that will be converted to JSON format and sent in the body of the request, through a `POST` method. |
| `data.status` | The `personalization` component notifies the Web SDK of the status of rendering. Supported values: <ul><li>`rendering-started`: Indicates that the Web SDK is about to render propositions. Before the Web SDK starts to render a decision scope or a view, in the `data` object you can see the propositions that are about to be rendered by the `personalization` component and the scope name.</li><li>`no-offers`: Indicates that no payload was received for the requested parameters.</li> <li>`rendering-failed`: Indicates that Web SDK failed to render a proposition.</li><li>`rendering-succeeded`: Indicates that rendering has completed for a decision scope.</li> <li>`rendering-redirect`: Indicates that Web SDK will render a redirect proposition.</li></ul> |

## `onContentHiding` {#onContentHiding}

This callback function is triggered before a prehiding style is applied or removed.

```js
onContentHiding(data) {
    // data.instanceName
    // data.componentName
    // data.status
}
```

|Parameter | Description |  
|---------|----------|
| `data.instanceName` | The name of the global variable where the Web SDK instance is stored. | 
| `data.componentName` | The name of the component that generated the log message. |
| `data.status` | The `personalization` component notifies the Web SDK of the status of rendering. Supported values: <ul><li>`rendering-started`: Indicates that the Web SDK is about to render propositions. Before the Web SDK starts to render a decision scope or a view, in the `data` object you can see the propositions that are about to be rendered by the `personalization` component and the scope name.</li><li>`no-offers`: Indicates that no payload was received for the requested parameters.</li> <li>`rendering-failed`: Indicates that Web SDK failed to render a proposition.</li><li>`rendering-succeeded`: Indicates that rendering has completed for a decision scope.</li> <li>`rendering-redirect`: Indicates that Web SDK will render a redirect proposition.</li></ul> |

## How to specify monitoring hooks when using the NPM package {#specify-monitoris-npm}

If you are using the Web SDK through the [NPM package](install/npm.md), you can specify monitoring hooks in the `createInstasnce` function, as shown below.

```js
var monitor = {
  onBeforeCommand(data) {
    console.log(data);
  },
  ...
};
var alloyLibrary = require("@adobe/alloy");
var alloy = alloyLibrary.createInstance({ name: "alloy", monitors: [monitor] });
alloy("config", { ... });
alloy("sendEvent", { ... });
```

## Example {#example}

The Web SDK looks for an array of objects in a global variable called `__alloyMonitors`.

To capture all Web SDK events, you must define your monitoring hooks before the Web SDK code is loaded on your page. Each monitoring method captures a Web SDK event.

See below an example page with all the monitoring hooks implemented.

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script>
    window.__alloyMonitors = window.__alloyMonitors || [];
    window.__alloyMonitors.push({
      onInstanceCreated(data) {
        // data.instanceName
        // data.instance
      },
      onInstanceConfigured(data) {
        // data.instanceName
        // data.config
      },
      onBeforeCommand(data) {
        // data.instanceName
        // data.commandName
        // data.options
      },
      // Added in version 2.4.0
      onCommandResolved(data) {
        // data.instanceName
        // data.commandName
        // data.options
        // data.result
      },
      // Added in version 2.4.0
      onCommandRejected(data) {
        // data.instanceName
        // data.commandName
        // data.options
        // data.error
      },
      onBeforeNetworkRequest(data) {
        // data.instanceName
        // data.requestId
        // data.url
        // data.payload
      },
      onNetworkResponse(data) {
        // data.instanceName
        // data.requestId
        // data.url
        // data.payload
        // data.body
        // data.parsedBody
        // data.status
        // data.retriesAttempted
      },
      onNetworkError(data) {
        // data.instanceName
        // data.requestId
        // data.url
        // data.payload
        // data.error
      },
      onBeforeLog(data) {
        // data.instanceName
        // data.componentName
        // data.level
        // data.arguments
      }
      onContentRendering(data) {
        // data.instanceName
        // data.componentName
        // data.payload
        // data.status
      },
      onContentHiding(data) {
        // data.instanceName
        // data.componentName
        // data.status
      }
    });
  </script>
  <script>
      !function(n,o){o.forEach(function(o){n[o]||((n.__alloyNS=n.__alloyNS||
      []).push(o),n[o]=function(){var u=arguments;return new Promise(
      function(i,l){n[o].q.push([i,l,u])})},n[o].q=[])})}
      (window,["alloy"]);
    </script>
    <script src="alloy.js" async></script>
</head>
<body>
  <h1>Monitor Test</h1>
</body>
</html>
```
